<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vérifiez votre éligibilité CPF - Formation</title>
  <style>
    /* ... Ton CSS est inchangé car il est bien structuré ... */
  </style>
</head>
<body>

<header>
  <h1>Vérifiez votre éligibilité aux formations CPF</h1>
</header>

<div class="logos" aria-label="Logos officiels partenaires">
  <img src="https://upload.wikimedia.org/wikipedia/commons/2/2b/Logo_CPF.svg" alt="Logo CPF" />
  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/02/Logo_Qualiopi.svg/512px-Logo_Qualiopi.svg.png" alt="Logo Qualiopi" />
  <img src="https://upload.wikimedia.org/wikipedia/commons/1/15/Embl%C3%A8me_de_la_R%C3%A9publique_fran%C3%A7aise_%28coq_gaulois%29.svg" alt="Logo République Française" />
</div>

<nav>
  <a href="#formulaire">Vérifier votre éligibilité</a>
</nav>

<div class="warnings" role="alert" aria-live="assertive">
  <p>⚠️ Nous ne proposons plus le financement du CACES ou du Permis de Conduire.</p>
  <p>⚠️ Les étudiants ne sont pas éligibles au financement des formations par le CPF.</p>
  <p>⚠️ Nous proposons UNIQUEMENT les formations qui se trouvent dans le formulaire ci-dessous.</p>
</div>

<section class="formations" aria-label="Liste des formations">
  <!-- Les cartes formation seront insérées par JavaScript -->
</section>

<section id="formulaire" aria-label="Formulaire d'éligibilité CPF">
  <h2>Formulaire d’éligibilité</h2>
  <form id="eligibiliteForm">
    <label for="nom">Nom complet *</label>
    <input type="text" id="nom" name="nom" required />

    <label for="email">Email *</label>
    <input type="email" id="email" name="email" required />

    <label for="telephone">Téléphone *</label>
    <input type="tel" id="telephone" name="telephone" required />

    <label for="formation">Formation souhaitée *</label>
    <select id="formation" name="formation" required>
      <option value="" disabled selected>-- Choisissez une formation --</option>
    </select>

    <button type="submit">Envoyer ma demande</button>
  </form>
  <div id="thankYouMessage" role="status" aria-live="polite" tabindex="-1" style="display: none;">
    Merci pour votre demande !<br />
    Ne soumettez pas une nouvelle demande.<br />
    Vous serez recontacté rapidement et recevrez le code de suivi AR26.
  </div>
</section>

<script>
  const formations = [/* ... tableau formations (inchangé) ... */];

  const container = document.querySelector('.formations');
  const selectFormation = document.querySelector('#formation');

  formations.forEach(f => {
    const card = document.createElement('div');
    card.className = 'card';
    card.tabIndex = 0;
    card.setAttribute('role', 'button');
    card.setAttribute('aria-label', `Vérifier l'éligibilité pour la formation ${f.titre}`);
    card.innerHTML = `
      <img src="${f.img}" alt="Image représentant la formation ${f.titre}" />
      <div class="card-content">
        <h3>${f.titre}</h3>
        <p>${f.desc}</p>
        <div class="btn-eligibilite" tabindex="0" role="button">Vérifier mon éligibilité</div>
      </div>
    `;
    container.appendChild(card);

    card.querySelector('.btn-eligibilite').addEventListener('click', () => scrollToForm(f.titre));
    card.addEventListener('click', () => scrollToForm(f.titre));
    card.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' || e.key === ' ') scrollToForm(f.titre);
    });

    const option = document.createElement('option');
    option.value = f.titre;
    option.textContent = f.titre;
    selectFormation.appendChild(option);
  });

  function scrollToForm(formation) {
    selectFormation.value = formation;
    document.getElementById("formulaire").scrollIntoView({ behavior: 'smooth' });
    selectFormation.focus();
  }

  const form = document.getElementById("eligibiliteForm");
  const message = document.getElementById("thankYouMessage");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const data = new FormData(form);
    const payload = Object.fromEntries(data.entries());

    try {
      await fetch("https://script.google.com/macros/s/AKfycbyvFDCrylG0OTBK98FBVBhySdHww-vW9X0KpOwtv3S2lwWc8yScqFeLSUbCZu69KDZr/exec", {
        method: "POST",
        body: new URLSearchParams(payload) // ✔ compatible no-cors
      });

      form.reset();
      form.style.display = "none";
      message.style.display = "block";
      message.focus();
    } catch (err) {
      alert("Erreur lors de l'envoi. Veuillez réessayer.");
    }
  });
</script>

</body>
</html>
